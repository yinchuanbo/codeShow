---
title: "Git开发工作流程"
date: 2024-03-02T10:11:57+08:00
---

## 一、开发分支模型分类

目前部门使用的主要是四种：dev(开发)、test(测试)、uat(预发布)、release(生产)

## 二、开发主体流程

1. 需求评审

2. 开发排期

3. 编码开发

4. 冒烟测试（自检查）

5. 冒烟通过，提交测试，合并代码到测试分支，部署测试环境

6. 测试环境测试，开发修 bug

7. 测试完成，提交预发布环境，合并代码到预发布分支，部署到预发布环境

8. 预发布环境测试，开发修 bug 

9. 测试完成，产品验收

10. 验收完成，提交生产，合并代码到生产分支，部署生产环境

11. 生产运营（客户）验收

12. 验收完成，结项

## 具体操作

### 1. 拉取代码

一般会在本地默认创建一个 master 分支

```sh
git clone https://code.xxx.com/xxx/xxx.git
```

### 2. 初次开发需求前，要先拉取生成/预发布分支，然后基于这个分支之上，创建自己的特性分支进行开发

```sh
git fetch origin release:release
git checkout release
git checkout -b feat-0131-jie
```

此时，在你本地已经有一个 release 分支对应着远程仓库 release 分支，还有一个内容基于 release 分支的特性分支，之后便可以在这个特性分支上进行需求开发，

如果不是初次开发，本地已经有生产/预发布分支，则需要重新拉取远程的最新代码，然后再创建

```sh
# tips: 输入已有的分支名时，可以只输入前几个字符，然后按 tab 自动补充
git checkout release
git pull origin release
git checkout -b feat-0229-jie
```

**注意1: 分支名称是有规范和含义的，不能乱取**

推荐格式：分支责任-需求日期/需求号-开发人姓名，一般按部门规范来，常见的有以下几种：

- feat: 新功能

- fix: 修补 bug

- doc: 文档

- refactor: 重构（既不是新增功能，也不是修改 bug 的代码变动）

- test: 测试

- chore: 构建过程或辅助工具的变动

**2. 为啥拉取的是生产/预发布分支**

之所以要拉取 `release/uat` 分支而不是拉取 `dev/test`，是因为后者可能包含着一些其他成员还未上线或者可能有 bug 的需求代码，这些代码没有通过验证，如果被你给拉取了，然后又基于此进行新的需求开发，那当你需求开发完成，而其他成员的需求还没上线，你将会把这些未验证的代码一起发送到 `uat/release` 上，导致一些列问题。

### 3. 需求开发完成，提交和合并代码

首先先在本地把新的改动提交，提交描述的格式可以参考着分支名的格式

- 如果是新需求的提交，可以写成 `"feat: 需求0131-新增账期"`

- 如果是 bug 修复，可以写成 `"fix: 禅道3387-重复请求"`

```sh
git add .
git commit -m "提交描述"
```

此时，本地当前分支已经记录了你的提交记录，接下来进行代码合并了。

在代码合并之前，我们先要梳理以下我们应该如何对分支进行管理（非常重要！！！）

1. 首先，我们需要认知到的是，每一个分支应该只对应一个功能，例如，当我们开发需求 01 时，那么就创建一个 `feat-01-jie` 分支进行开发；开发需求 02 时，就另外创建一个 `feat-02-jie` 分支进行开发，修改生产环境的某个 bug 时，就创建 `fix-jie-3378` 进行开发，等等。

2. 其次，在合并代码时，我们要将四种分支模型（dev、test、uat、release）作为参照物，而不是把关注点放在自己的分支上，比如我们要在 dev 上调试，那就需要把自己的分支合并到 dev 分支上，如果我们需要提测，则把自己的分支合并到 test 分支上，以此类推。

即，我们要关注到，这四个环境的分支上，会有什么内容，会新增什么内容，**[ 切记不能反过来将除了 release 之外的三个分支合并到自己的代码上！！！ ]** 如果其他成员将自己的代码也提交到 dev 分支上，但是这个代码是没有通过验证的，此时你将 dev 往自己的分支上合，那之后的提测、上预发布、生产则很大概率会出问题。**[ 所以一定要保持自己的分支是干净的 ]** 而 release 分支对应的是生成环境，一般是最稳定的版本，所以合并到自己的分支以获取最新的更改是没有问题的。

