<!DOCTYPE html>






























<html
  class="not-ready text-sm lg:text-base"
  style="--bg: "
  lang="en"
>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

  
  <title>文件操作 - 灏天阁</title>

  
  <meta name="theme-color" />
  
  <meta name="description" content="FileList File 控件新添 multiple 属性，允许用户在一个 File 控件内选择和提交多个文件。
&lt;input type=&#34;file&#34; multiple /&gt; 示例
&lt;input type=&#34;file&#34; id=&#34;file&#34; multiple /&gt; &lt;input type=&#34;button&#34; onclick=&#34;ShowFileName()&#34; value=&#34;文件上传&#34; /&gt; function ShowFileName() { for (var i = 0; i &lt; document.getElementById(&#34;file&#34;).files.length; i&#43;&#43;) { var file = document.getElementById(&#34;file&#34;).files[i]; console.log(file.name); } } Blob Blob 对象用于存储二进制数据，还可以设置存储数据的 MIME 类型，
访问 Blob Blob 对象包含两个属性：
size: 表示一个 Blob 对象的字节长度
type: 表示 Blob 的 MIME 类型，如果为未知类型，则返回一个空字符串。
下面演示如果获取文件域中第一个文件的 Blob 对象，并访问该文件的长度和文件类型
function showFileType() { var file = document." />
  <meta name="author" content="" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="/articles/main.min.css" />

  

  
  
  
    
  
  <link
    rel="preload"
    as="image"
    href="/articles/theme.png"
  />

  
  
  
  <link rel="preload" as="image" href="/imgs/logo.png" />
  
  

  

  
  <link rel="icon" href="/img/ico.ico" />
  <link rel="apple-touch-icon" href="/articles/apple-touch-icon.png" />
  
  <meta name="generator" content="Hugo 0.108.0">

  
  

  
  
  
  
  
  
  
  
  
  <meta property="og:title" content="文件操作" />
<meta property="og:description" content="FileList File 控件新添 multiple 属性，允许用户在一个 File 控件内选择和提交多个文件。
&lt;input type=&#34;file&#34; multiple /&gt; 示例
&lt;input type=&#34;file&#34; id=&#34;file&#34; multiple /&gt; &lt;input type=&#34;button&#34; onclick=&#34;ShowFileName()&#34; value=&#34;文件上传&#34; /&gt; function ShowFileName() { for (var i = 0; i &lt; document.getElementById(&#34;file&#34;).files.length; i&#43;&#43;) { var file = document.getElementById(&#34;file&#34;).files[i]; console.log(file.name); } } Blob Blob 对象用于存储二进制数据，还可以设置存储数据的 MIME 类型，
访问 Blob Blob 对象包含两个属性：
size: 表示一个 Blob 对象的字节长度
type: 表示 Blob 的 MIME 类型，如果为未知类型，则返回一个空字符串。
下面演示如果获取文件域中第一个文件的 Blob 对象，并访问该文件的长度和文件类型
function showFileType() { var file = document." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/articles/posts/108/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-27T22:20:05+08:00" />
<meta property="article:modified_time" content="2024-01-27T22:20:05+08:00" />

  
  <meta itemprop="name" content="文件操作">
<meta itemprop="description" content="FileList File 控件新添 multiple 属性，允许用户在一个 File 控件内选择和提交多个文件。
&lt;input type=&#34;file&#34; multiple /&gt; 示例
&lt;input type=&#34;file&#34; id=&#34;file&#34; multiple /&gt; &lt;input type=&#34;button&#34; onclick=&#34;ShowFileName()&#34; value=&#34;文件上传&#34; /&gt; function ShowFileName() { for (var i = 0; i &lt; document.getElementById(&#34;file&#34;).files.length; i&#43;&#43;) { var file = document.getElementById(&#34;file&#34;).files[i]; console.log(file.name); } } Blob Blob 对象用于存储二进制数据，还可以设置存储数据的 MIME 类型，
访问 Blob Blob 对象包含两个属性：
size: 表示一个 Blob 对象的字节长度
type: 表示 Blob 的 MIME 类型，如果为未知类型，则返回一个空字符串。
下面演示如果获取文件域中第一个文件的 Blob 对象，并访问该文件的长度和文件类型
function showFileType() { var file = document."><meta itemprop="datePublished" content="2024-01-27T22:20:05+08:00" />
<meta itemprop="dateModified" content="2024-01-27T22:20:05+08:00" />
<meta itemprop="wordCount" content="528">
<meta itemprop="keywords" content="" />
  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="文件操作"/>
<meta name="twitter:description" content="FileList File 控件新添 multiple 属性，允许用户在一个 File 控件内选择和提交多个文件。
&lt;input type=&#34;file&#34; multiple /&gt; 示例
&lt;input type=&#34;file&#34; id=&#34;file&#34; multiple /&gt; &lt;input type=&#34;button&#34; onclick=&#34;ShowFileName()&#34; value=&#34;文件上传&#34; /&gt; function ShowFileName() { for (var i = 0; i &lt; document.getElementById(&#34;file&#34;).files.length; i&#43;&#43;) { var file = document.getElementById(&#34;file&#34;).files[i]; console.log(file.name); } } Blob Blob 对象用于存储二进制数据，还可以设置存储数据的 MIME 类型，
访问 Blob Blob 对象包含两个属性：
size: 表示一个 Blob 对象的字节长度
type: 表示 Blob 的 MIME 类型，如果为未知类型，则返回一个空字符串。
下面演示如果获取文件域中第一个文件的 Blob 对象，并访问该文件的长度和文件类型
function showFileType() { var file = document."/>

  
  
</head>
  <body class="text-black duration-200 ease-out dark:text-white">
    
    

    
    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-10rem)] max-w-3xl px-8 pt-20 dark:prose-invert"
      id="main"
    >
      

<article>
  <header class="mb-10">
    <h1 class="!my-0 pb-2.5">
      文件操作
    </h1>

    
    <div class="text-sm opacity-60">
      
      <time>Jan 27, 2024</time>
      
      
      <span class="mx-1">&middot;</span>
      <span>Yin灏</span>
    </div>
    
  </header>

  <section><h2 id="filelist">FileList</h2>
<p>File 控件新添 multiple 属性，允许用户在一个 File 控件内选择和提交多个文件。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">multiple</span> /&gt;
</span></span></code></pre></div><p><strong>示例</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">multiple</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ShowFileName()&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;文件上传&#34;</span> /&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">ShowFileName</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;file&#34;</span>).<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;file&#34;</span>).<span style="color:#a6e22e">files</span>[<span style="color:#a6e22e">i</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">name</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="blob">Blob</h2>
<p>Blob 对象用于存储二进制数据，还可以设置存储数据的 MIME 类型，</p>
<h3 id="访问-blob">访问 Blob</h3>
<p>Blob 对象包含两个属性：</p>
<ul>
<li>
<p>size: 表示一个 Blob 对象的字节长度</p>
</li>
<li>
<p>type: 表示 Blob 的 MIME 类型，如果为未知类型，则返回一个空字符串。</p>
</li>
</ul>
<p><strong>下面演示如果获取文件域中第一个文件的 Blob 对象，并访问该文件的长度和文件类型</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">showFileType</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;file&#34;</span>).<span style="color:#a6e22e">files</span>[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">size</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">type</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>注意：对于图像类型的文件，Blob 对象的 type 属性都是以 “image/” 开头，后面是图像类型。</p>
</blockquote>
<p><strong>利用 Blob 的 type 属性，判断用户选择的文件是否为图像文件</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">multiple</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;fileUpload()&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;文件上传&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">fileUpload</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fileDom</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;file&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">fileDom</span>.<span style="color:#a6e22e">files</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fileDom</span>.<span style="color:#a6e22e">files</span>[<span style="color:#a6e22e">i</span>];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#e6db74">/image\/\w+/</span>.<span style="color:#a6e22e">test</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">type</span>)) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">alert</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;不是图像文件!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">alert</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;文件已上传!&#34;</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><blockquote>
<p>拓展：file 控件新添加 accept 属性，设置 file 控件只能接受某种类型的文件，<code>&lt;input type=&quot;file&quot; id=&quot;file&quot; accept=&quot;image/*&quot; /&gt;</code></p>
</blockquote>
<h3 id="创建-blob">创建 Blob</h3>
<ul>
<li>基本语法</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>(<span style="color:#a6e22e">blobParts</span>, <span style="color:#a6e22e">type</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  1. blobParts: 可选参数，数组类型，其中可以存放任意个以下类型的对象，这些对象中所携带的数据将被依序追加到 Blob 对象中，
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  - ArrayBuffer 对象
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  - ArrayBufferView 对象
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  - Blob 对象
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  2. type: 可选参数，字符串类型，设置被创建的 Blob 对象的 type 属性值，即定义 Blob 对象 MIME 类型。默认参数值为空字符串，表示未知类型。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span></code></pre></div><p>注：当创建 Blob 对象时，可以使用两个可选参数，如果不使用任何参数，创建的 Blob 对象的 size 属性值为 0，即 Blob 对象的字节长度为 0。即 <code>var blob = new Blob()</code></p>
<p><strong>下面演示如何设置第一个参数</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#e6db74">&#34;4234&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;5678&#34;</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">shorts</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint16Array</span>(<span style="color:#a6e22e">buffer</span>, <span style="color:#ae81ff">622</span>, <span style="color:#ae81ff">128</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blobA</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#a6e22e">blob</span>, <span style="color:#a6e22e">shorts</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">bytes</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>(<span style="color:#a6e22e">buffer</span>, <span style="color:#a6e22e">shorts</span>.<span style="color:#a6e22e">byteOffset</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">shorts</span>.<span style="color:#a6e22e">byteLength</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blobB</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#a6e22e">blob</span>, <span style="color:#a6e22e">blobA</span>, <span style="color:#a6e22e">bytes</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blobC</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#a6e22e">buffer</span>, <span style="color:#a6e22e">blob</span>, <span style="color:#a6e22e">blobA</span>, <span style="color:#a6e22e">bytes</span>]);
</span></span></code></pre></div><p><strong>下面演示如何设置第二个参数</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#e6db74">&#34;4234&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;5678&#34;</span>], { <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;text/plain&#34;</span> });
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#e6db74">&#34;4234&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;5678&#34;</span>], { <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;text/plain;charset=UTF-8&#34;</span> });
</span></span></code></pre></div><p><strong>下面完整的演示如何创建一个 Blob 对象</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">textarea</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;textarea&#34;</span>&gt;&lt;/<span style="color:#f92672">textarea</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;test()&#34;</span>&gt;创建 Blob 对象&lt;/<span style="color:#f92672">button</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;result&#34;</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">test</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;textarea&#34;</span>).<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;result&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 创建 Blob 对象
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>window.<span style="color:#a6e22e">Blob</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;浏览器不支持 Blob 对象&#34;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">blob</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Blob</span>([<span style="color:#a6e22e">text</span>]);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (window.<span style="color:#a6e22e">URL</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`&lt;a download href=&#34;</span><span style="color:#e6db74">${</span>window.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">createObjectURL</span>(
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">blob</span>
</span></span><span style="display:flex;"><span>        )<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; target=&#34;_blank&#34;&gt;Blob 对象文件下载&lt;/a&gt;`</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h3 id="截取-blob">截取 Blob</h3>
<p>Blob 对象包含 slice() 方法，它可以从 Blob 对象中截取一部分数据，然后将这些数据创建为一个新的 Blob 对象并返回，</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">newBlob</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">blob</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#a6e22e">start</span>, <span style="color:#a6e22e">end</span>, <span style="color:#a6e22e">contentType</span>);
</span></span></code></pre></div><ol>
<li>start: 可选参数，整数值，设置起始位置</li>
</ol>
<ul>
<li>如果值是 0，表示从第一个字节开始复制数据。</li>
<li>如果值是负值，且 Blob 对象的 size 属性值 + start 参数值大于等于 0，则起始位置为 Blob 对象的 size 属性值 + start 参数值。</li>
<li>如果值是负值，且 Blob 对象的 size 属性值 + start 参数值小于 0，则起始位置为 Blob 对象的起点位置。</li>
<li>如果值是正数，且大于等于 Blob 对象的 size 属性值，则起始位置为 Blob 对象的 size 属性值。</li>
<li>如果值为正数，且小于 Blob 对象的 size 属性值，则起始位置为 start 参数值。</li>
</ul>
<ol start="2">
<li>end: 可选参数，整数值，设置终点位置</li>
</ol>
<ul>
<li>如果忽略该参数，则终点位置为 Blob 对象的结束位置。</li>
<li>如果值为负数，且 Blob 对象的 size 属性值 + end 参数值大于等于 0，则终点位置为 Blob 对象的 size 属性值 + end 参数值。</li>
<li>如果值为负数，且 Blob 对象的 size 属性值 + end 参数值小于 0，则终点位置为 Blob 对象的起始位置。</li>
<li>如果值为正数，且大于等于 Blob 对象的 size 属性值，则终点位置为 Blob 对象的 size 属性值。</li>
<li>如果值为正数，且小于 Blob 对象的 size 属性值，则终点位置为 end 参数值。</li>
</ul>
<ol start="3">
<li>contentType: 可选参数，字符串值，指定新建 Blob 对象的 MIME 类型，</li>
</ol>
<p>如果 slice() 方法的三个参数均省略，相当于把一个 Blob 对象原样复制到一个新建的 Blob 对象中。</p>
<p><strong>下面演示 Blob 对象的 slice() 方法应用</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#a6e22e">multiple</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;button&#34;</span> <span style="color:#a6e22e">onclick</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;showFileType()&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;文件上传&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">showFileType</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;file&#34;</span>).<span style="color:#a6e22e">files</span>[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">file</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file1</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">slice</span>(); <span style="color:#75715e">// 复制 file 对象
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">size</span>); <span style="color:#75715e">// 复制 file 对象
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file3</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#f92672">-</span>Math.<span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">size</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)); <span style="color:#75715e">// 复制 file 对象的后半部分
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file4</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">0</span>, Math.<span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">size</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)); <span style="color:#75715e">// 复制 file 对象的前半部分
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">// 复制 file 对象，从开始处复制到结束之前的 150 个字节处，并设置 MIME 类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">file5</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">file</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">150</span>, <span style="color:#e6db74">&#34;application/plain&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div></section>

  
  

  
  
  
  <nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]">
    
    <a class="flex w-1/2 items-center p-6 pr-3 no-underline" href="/articles/posts/109/"
      ><span class="mr-1.5">←</span><span>FileReader</span></a
    >
    
    
    <a
      class="ml-auto flex w-1/2 items-center justify-end p-6 pl-3 no-underline"
      href="/articles/posts/107/"
      ><span>Web Storage</span><span class="ml-1.5">→</span></a
    >
    
  </nav>
  

  
  
</article>


    </main>

    <footer
  class="opaco mx-auto flex h-[5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"
  style="position: relative; z-index: 10;display: none;"
>
  <div class="mr-auto">
    &copy; 2024
    <a class="link" href="/articles/">灏天阁</a>
  </div>
  <a class="link" href="https://yinchuanbo.github.io/" rel="noopener" target="_blank"
    >Powered by YinHao</a
  >️ ▷
</footer>


    <div class="img__mask" style="display: none;">
      <img src="" alt="">
      <span class="close_btn"></span>
    </div>

    <script>
      const imgs = document.images;
      const imgMask = document.querySelector('.img__mask')
      const closeBtn = document.querySelector('.close_btn')
      for (let i = 0; i < imgs.length; i++) {
        const element = imgs[i];
        element.onclick = () => {
          const src = element.src;
          imgMask.style.display = 'flex';
          imgMask.querySelector('img').src = src;
        }
      }
      closeBtn.onclick = () => {
        imgMask.style.display = 'none';
      }
    </script>
  </body>
</html>
